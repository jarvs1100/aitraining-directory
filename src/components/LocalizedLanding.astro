---
import Breadcrumbs from './Breadcrumbs.astro';
import { localeMeta, getLocalizedSupportBlocks, getLocalizedUiStrings } from '../lib/i18n.js';
const { page, alternates = [], siblingPages = [] } = Astro.props;
const currentLocaleName = localeMeta[page.locale]?.name || page.locale.toUpperCase();
const supportBlocks = getLocalizedSupportBlocks(page.key, page.locale);
const ui = getLocalizedUiStrings(page.locale);
const longformSections = Array.isArray(page.sections) ? page.sections : [];
---
<Breadcrumbs items={[{ label: ui.home, href: `/${page.locale}/` }, { label: currentLocaleName, href: `/${page.locale}/` }, { label: page.h1, href: `/${page.locale}/${page.slug}/` }]} />
<section class="hero">
  <span class="eyebrow">{supportBlocks.labels.editionTag}</span>
  <h1 style="margin-top:0.8rem;">{page.h1}</h1>
  <p class="muted">{page.intro}</p>
  <div class="grid" style="margin-top:1rem;">
    {page.points.map((point) => (
      <article class="card">
        <h3>{point}</h3>
        <p class="muted" style="margin:0;">{ui.pointSupportCopy}</p>
      </article>
    ))}
  </div>
  <div class="hero-actions" style="margin-top:1rem;">
    <a class="btn btn-primary" href={page.enPath}>{supportBlocks.labels.openEnglishPageCta}</a>
    <a class="btn btn-secondary" href="/advertise/">{supportBlocks.labels.waitlistCta}</a>
  </div>
</section>

{Boolean(longformSections.length) && (
  <>
    {longformSections.map((section) => (
      <section class="section card" aria-labelledby={`${section.id}-heading`}>
        <h2 id={`${section.id}-heading`}>{section.heading}</h2>
        {Array.isArray(section.body) ? section.body.map((paragraph) => (
          <p class="muted">{paragraph}</p>
        )) : Boolean(section.body) && (
          <p class="muted">{section.body}</p>
        )}
        {Array.isArray(section.bullets) && Boolean(section.bullets.length) && (
          <ul>
            {section.bullets.map((item) => <li>{item}</li>)}
          </ul>
        )}
      </section>
    ))}
  </>
)}

<section class="section" aria-labelledby="checklist-heading">
  <h2 id="checklist-heading">{supportBlocks.labels.checklistHeading}</h2>
  <ul>
    {supportBlocks.checklist.map((item) => <li>{item}</li>)}
  </ul>
</section>

<section class="section" aria-labelledby="next-links-heading">
  <h2 id="next-links-heading">{supportBlocks.labels.nextPagesHeading}</h2>
  <div class="chips">
    {supportBlocks.internalLinks.map((item) => (
      <a class="chip" href={item.href}>{item.label}</a>
    ))}
  </div>
</section>

<section class="section card" aria-labelledby="trust-method-heading">
  <h2 id="trust-method-heading">{supportBlocks.parityFramework.landingTrustHeading}</h2>
  <ul>
    {supportBlocks.trustBullets.map((item) => <li>{item}</li>)}
  </ul>
  <div class="chips chips-nav">
    {supportBlocks.methodologyLinks.map((item) => (
      <a class="chip" href={item.href}>{item.label}</a>
    ))}
  </div>
  {Boolean(supportBlocks.parityFramework.lectureGuruNote) && (
    <p class="muted" style="margin-top:.75rem;font-size:14px;">{supportBlocks.parityFramework.lectureGuruNote}</p>
  )}
</section>

<section class="section card" aria-labelledby="routing-quality-heading">
  <h2 id="routing-quality-heading">{supportBlocks.parityFramework.routingHeading}</h2>
  <ul>
    {supportBlocks.routingChecks.map((item) => <li>{item}</li>)}
  </ul>
</section>

<section class="section card" aria-labelledby="parity-framework-heading">
  <h2 id="parity-framework-heading">{supportBlocks.parityFramework.heading}</h2>
  <p class="muted">{supportBlocks.parityFramework.intro}</p>
  <ul>
    {supportBlocks.parityFramework.dimensions.map((dimension) => (
      <li>{dimension.localizedName}</li>
    ))}
  </ul>
</section>

{Boolean(siblingPages.length) && (
  <section class="section" aria-labelledby="other-editions-heading">
    <h2 id="other-editions-heading">{supportBlocks.labels.otherLanguagesHeading}</h2>
    <div class="chips">
      {siblingPages.map((item) => (
        <a class="chip" href={`/${item.locale}/${item.slug}/`}>{localeMeta[item.locale]?.name || item.locale.toUpperCase()}</a>
      ))}
    </div>
  </section>
)}
<p class="muted" style="font-size:14px;">{supportBlocks.intentCopy}</p>
