---
import Base from '../../layouts/Base.astro';
import Breadcrumbs from '../../components/Breadcrumbs.astro';
import { getCategories, getCategoryBySlug, getListingsByCategorySlug } from '../../lib/data.js';

export async function getStaticPaths() {
  return getCategories().map((c) => ({ params: { slug: c.slug } }));
}

const { slug } = Astro.params;
const category = getCategoryBySlug(slug);
const tools = getListingsByCategorySlug(slug);

if (!category) {
  throw new Error(`Category not found: ${slug}`);
}

const canonical = `https://aitraining.directory/category/${slug}/`;

const jsonLd = {
  '@context': 'https://schema.org',
  '@type': 'CollectionPage',
  name: `${category.name} tools`,
  url: canonical,
  mainEntity: tools.map((tool) => ({
    '@type': 'SoftwareApplication',
    name: tool.name,
    applicationCategory: category.name,
    offers: { '@type': 'Offer', price: '0', priceCurrency: 'USD' }
  }))
};
---
<Base
  title={`${category.name} Tools | AI Training Directory`}
  description={`Compare ${category.name} tools for training, onboarding, and L&D use cases.`}
  canonical={canonical}
  jsonLd={jsonLd}
>
  <Breadcrumbs items={[{ label: 'Home', href: '/' }, { label: 'Categories', href: '/categories/' }, { label: category.name, href: `/category/${slug}/` }]} />

  <section class="hero" style="margin-bottom:1.25rem;">
    <span class="eyebrow">{tools.length} options</span>
    <div class="chips" style="margin-bottom:.8rem;">
      <span class="badge badge-active">{category.name}</span>
      <span class="badge">Shortlist-ready</span>
    </div>
    <h1 style="margin-top:.7rem;">{category.name} tools for modern training teams</h1>
    <p class="muted" style="max-width:70ch;">Compare feature fit, pricing model, and workflow compatibility before piloting tools with your L&D stakeholders.</p>
    <div class="hero-actions">
      <a class="btn btn-primary" href="/compare/">Compare alternatives</a>
      <a class="btn btn-secondary" href="/solutions/">Browse implementation playbooks</a>
    </div>
  </section>

  <section aria-labelledby="category-list-heading">
    <h2 id="category-list-heading">Tools in this category</h2>
    <div class="grid">
      {tools.map((tool) => (
        <article class="card">
          <div class="chips" style="margin-bottom:.85rem;"><span class="badge">{tool.pricing}</span></div>
          <h3 style="margin-bottom:.45rem;"><a href={`/tool/${tool.slug}/`} style="color:inherit;">{tool.name}</a></h3>
          <p class="muted" style="margin:0;">{tool.summary}</p>
        </article>
      ))}
    </div>
  </section>

  <p class="section"><a class="chip" href="/advertise/">Need visibility in this category? Join founding partner waitlist.</a></p>
</Base>
