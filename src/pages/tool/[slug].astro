---
import Base from '../../layouts/Base.astro';
import Breadcrumbs from '../../components/Breadcrumbs.astro';
import { allListings, getCategorySlug } from '../../lib/data.js';

export async function getStaticPaths() {
  return allListings.map((tool) => ({ params: { slug: tool.slug } }));
}

const { slug } = Astro.params;
const tool = allListings.find((t) => t.slug === slug);

if (!tool) {
  throw new Error(`Tool not found: ${slug}`);
}

const canonical = `https://aitraining.directory/tool/${tool.slug}/`;
const categorySlug = getCategorySlug(tool.category);
const relatedTools = allListings.filter((item) => item.category === tool.category && item.slug !== tool.slug).slice(0, 3);
const jsonLd = {
  '@context': 'https://schema.org',
  '@graph': [
    {
      '@type': 'SoftwareApplication',
      name: tool.name,
      description: tool.summary,
      url: tool.website,
      applicationCategory: tool.category,
      offers: {
        '@type': 'Offer',
        price: tool.pricing === 'Paid' ? 'Paid plan' : '0',
        priceCurrency: 'USD'
      }
    },
    {
      '@type': 'FAQPage',
      mainEntity: [
        {
          '@type': 'Question',
          name: `What is ${tool.name} best for in L&D?`,
          acceptedAnswer: {
            '@type': 'Answer',
            text: `${tool.name} is generally used for training content workflows where teams need faster creation and consistent delivery.`
          }
        },
        {
          '@type': 'Question',
          name: `How should teams evaluate ${tool.name}?`,
          acceptedAnswer: {
            '@type': 'Answer',
            text: 'Pilot one high-friction workflow first (onboarding, SOP updates, or coaching content), then measure cycle-time and adoption before scaling.'
          }
        }
      ]
    }
  ]
};
---
<Base
  title={`${tool.name} Review & Alternatives | AI Training Directory`}
  description={`${tool.name}: features, pricing model, and fit for AI training workflows.`}
  canonical={canonical}
  jsonLd={jsonLd}
>
  <Breadcrumbs items={[{ label: 'Home', href: '/' }, { label: tool.category, href: `/category/${categorySlug}/` }, { label: tool.name, href: `/tool/${tool.slug}/` }]} />

  <article>
    <header class="hero" style="margin-bottom:1.25rem;">
      <div class="chips" style="margin-bottom:.8rem;">
        <span class="badge">{tool.category}</span>
        <span class="badge">{tool.pricing}</span>
      </div>
      <h1 style="margin-bottom:.7rem;">{tool.name}</h1>
      <p class="muted" style="max-width:72ch;">{tool.summary}</p>
      <div class="hero-actions">
        <a class="btn btn-primary" href={tool.website} target="_blank" rel="nofollow noopener">Visit {tool.name} â†—</a>
        <a class="btn btn-secondary" href={`/category/${categorySlug}/`}>More {tool.category} tools</a>
        <a class="btn btn-secondary" href="/compare/">Compare alternatives</a>
      </div>
    </header>

    <section class="card" aria-labelledby="features-heading">
      <h2 id="features-heading">Key features</h2>
      <ul>
        {tool.features.map((feature) => <li>{feature}</li>)}
      </ul>
    </section>

    <section class="section card" aria-labelledby="fit-heading">
      <h2 id="fit-heading">Who this is for</h2>
      <p class="muted" style="margin-bottom:0;">Teams building repeatable onboarding, SOP, and internal training workflows that need faster content production without sacrificing quality controls.</p>
    </section>

    {Boolean(relatedTools.length) && (
      <section class="section" aria-labelledby="related-heading">
        <h2 id="related-heading">Related tools in {tool.category}</h2>
        <div class="grid">
          {relatedTools.map((item) => (
            <article class="card">
              <h3><a href={`/tool/${item.slug}/`}>{item.name}</a></h3>
              <p class="muted" style="margin:0;">{item.summary}</p>
            </article>
          ))}
        </div>
      </section>
    )}

    <p class="section"><a class="chip" href="/solutions/">See scenario-based picks</a></p>
  </article>
</Base>
